import base64
encoded_kod = "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoKaW1wb3J0IHRpbWUKaW1wb3J0IHJhbmRvbQppbXBvcnQgaGFzaGxpYgppbXBvcnQgcmVxdWVzdHMKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgZGVmYXVsdGRpY3QKZnJvbSByaWNoLmNvbnNvbGUgaW1wb3J0IENvbnNvbGUKZnJvbSByaWNoLnRhYmxlIGltcG9ydCBUYWJsZQpmcm9tIHJpY2gucHJvZ3Jlc3MgaW1wb3J0IHRyYWNrCmZyb20gYWxpdmVfcHJvZ3Jlc3MgaW1wb3J0IGFsaXZlX2JhcgoKY29uc29sZSA9IENvbnNvbGUoKQoKY2xhc3MgSGFzaENyYWNrZXI6CiAgICBWRVJTSU9OID0gIjAuMC4xIgogICAgREVTQ1JJUFRJT04gPSAiUGFzc2Rvb20gSGFzaCBDcmFja2VyIgogICAgQVVUSE9SID0gIkNxTGkiCiAgICBXT1JETElTVF9DUkVBVE9SID0gIldvcmRsaXN0IEtpbmcgQ3FMaSIKICAgIFdPUkRMSVNUX1VSTFMgPSBbCiAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9DcUxpLUZpL1Bhc3Nkb29tLVdvcmRsaXN0L3JlZnMvaGVhZHMvbWFpbi9Xb3JkbGlzdC90dXJraXNoLnR4dCcsCiAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9DcUxpLUZpL1Bhc3Nkb29tLVdvcmRsaXN0L3JlZnMvaGVhZHMvbWFpbi9Xb3JkbGlzdC90dXJraXNoMi50eHQnLAogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ3FMaS1GaS9QYXNzZG9vbS1Xb3JkbGlzdC9yZWZzL2hlYWRzL21haW4vV29yZGxpc3QvZW5nbGlzaC50eHQnLAogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ3FMaS1GaS9QYXNzZG9vbS1Xb3JkbGlzdC9yZWZzL2hlYWRzL21haW4vV29yZGxpc3QvbnVtYmVycy50eHQnLAogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ3FMaS1GaS9QYXNzZG9vbS1Xb3JkbGlzdC9yZWZzL2hlYWRzL21haW4vV29yZGxpc3QvZGF0YTExXzIwMjQudHh0JywKICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0NxTGktRmkvUGFzc2Rvb20tV29yZGxpc3QvcmVmcy9oZWFkcy9tYWluL1dvcmRsaXN0L2Z0cC50eHQnLAogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20va2tyeXB0MG5uL3dvcmRsaXN0cy9yZWZzL2hlYWRzL21haW4vd29yZGxpc3RzL3Bhc3N3b3Jkcy9idDRfcGFzc3dvcmRzLnR4dCcsCiAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9ra3J5cHQwbm4vd29yZGxpc3RzL3JlZnMvaGVhZHMvbWFpbi93b3JkbGlzdHMvcGFzc3dvcmRzL21kNWRlY3J5cHRvci50eHQnCiAgICBdCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGZpbGVuYW1lPU5vbmUpOgogICAgICAgIHNlbGYuZGlzcGxheV9pbnRyb19hbmltYXRpb24oKQogICAgICAgIGlmIGZpbGVuYW1lOgogICAgICAgICAgICBzZWxmLmZpbGVuYW1lID0gZmlsZW5hbWUKICAgICAgICAgICAgc2VsZi5tZDVfaGFzaGVzID0gW10KICAgICAgICAgICAgc2VsZi5zaGExX2hhc2hlcyA9IFtdCiAgICAgICAgICAgIHNlbGYuZm91bmRfaGFzaGVzID0ge30KICAgICAgICAgICAgc2VsZi51bmZvdW5kX2hhc2hlcyA9IFtdCiAgICAgICAgICAgIHNlbGYuY2FjaGUgPSBkZWZhdWx0ZGljdChzdHIpCiAgICAgICAgICAgIHNlbGYubG9hZF9oYXNoZXMoKQogICAgICAgICAgICBzZWxmLmxvYWRfY2FjaGUoKQogICAgICAgICAgICBzZWxmLndvcmRsaXN0ID0gc2VsZi5sb2FkX3dvcmRsaXN0KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdXNhZ2VfaW5zdHJ1Y3Rpb25zKCkKCiAgICBkZWYgZGlzcGxheV9pbnRyb19hbmltYXRpb24oc2VsZik6CiAgICAgICAgIiIiRGlzcGxheXMgdGhlIG1hdHJpeC1zdHlsZSBpbnRybyBhbmltYXRpb24uIiIiCiAgICAgICAgY29uc29sZS5wcmludCgiXG5bYm9sZCBncmVlbl1QYXNzZG9vbSBIYXNoIENyYWNrZXJbL2JvbGQgZ3JlZW5dXG4iLCBzdHlsZT0iYm9sZCBncmVlbiIpCiAgICAgICAgYW5pbWF0aW9uX2NoYXJhY3RlcnMgPSBbCiAgICAgICAgICAgICJBLkIuRy5FLlIuVC5ZLlIuVy5FLlEuVy5FLlJXLiIsCiAgICAgICAgICAgICIxLjMuNC4yNS4yNi4zNi4zLjYuMy4zLjcuMy42My4yIiwKICAgICAgICAgICAgIislJi8vJSslJi8oKT0/PSgvJisrXiIsCiAgICAgICAgICAgICJAIyQlJiooKSFeKz0tW117fTs6LC4vPD4/IgogICAgICAgIF0KICAgICAgICAKICAgICAgICBmb3IgXyBpbiByYW5nZSgzMCk6CiAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoCiAgICAgICAgICAgICAgICByYW5kb20uY2hvaWNlKGFuaW1hdGlvbl9jaGFyYWN0ZXJzKSwKICAgICAgICAgICAgICAgIHN0eWxlPSJib2xkIGN5YW4iIGlmIHJhbmRvbS5yYW5kaW50KDAsIDEpIGVsc2UgImJvbGQgZ3JlZW4iCiAgICAgICAgICAgICkKICAgICAgICAgICAgdGltZS5zbGVlcCgwLjAzKQogICAgICAgIAogICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICBjb25zb2xlLnByaW50KCJbYm9sZCBjeWFuXS0tLSBXZWxjb21lIHRvIFBhc3Nkb29tIC0tLVsvYm9sZCBjeWFuXSIpCiAgICAgICAgdGltZS5zbGVlcCgxKQoKICAgIGRlZiBkaXNwbGF5X3VzYWdlX2luc3RydWN0aW9ucyhzZWxmKToKICAgICAgICBjb25zb2xlLnByaW50KCJbeWVsbG93XVVzYWdlIGV4YW1wbGU6IHB5dGhvbjMgcGFzc2Rvb20ucHkgaGFzaC50eHRbL3llbGxvd11cbiIpCiAgICAgICAgY29uc29sZS5wcmludChmIlt5ZWxsb3dde3NlbGYuREVTQ1JJUFRJT059IHtzZWxmLlZFUlNJT059Wy95ZWxsb3ddIikKICAgICAgICBjb25zb2xlLnByaW50KGYiW3llbGxvd117c2VsZi5BVVRIT1J9IC0ge3NlbGYuV09SRExJU1RfQ1JFQVRPUn1cblsveWVsbG93XSIpCgogICAgZGVmIGxvYWRfaGFzaGVzKHNlbGYpOgogICAgICAgIHdpdGggb3BlbihzZWxmLmZpbGVuYW1lLCAncicpIGFzIGZpbGU6CiAgICAgICAgICAgIGZvciBsaW5lIGluIGZpbGU6CiAgICAgICAgICAgICAgICBsaW5lID0gbGluZS5zdHJpcCgpCiAgICAgICAgICAgICAgICBpZiBsZW4obGluZSkgPT0gMzIgYW5kIGFsbChjIGluICcwMTIzNDU2Nzg5YWJjZGVmQUJDREVGJyBmb3IgYyBpbiBsaW5lKToKICAgICAgICAgICAgICAgICAgICBzZWxmLm1kNV9oYXNoZXMuYXBwZW5kKGxpbmUubG93ZXIoKSkKICAgICAgICAgICAgICAgIGVsaWYgbGVuKGxpbmUpID09IDQwIGFuZCBhbGwoYyBpbiAnMDEyMzQ1Njc4OWFiY2RlZkFCQ0RFRicgZm9yIGMgaW4gbGluZSk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaGExX2hhc2hlcy5hcHBlbmQobGluZS5sb3dlcigpKQoKICAgICAgICBjb25zb2xlLnByaW50KGYiW2dyZWVuXUxvYWRlZCB7bGVuKHNlbGYubWQ1X2hhc2hlcyl9IHVuaXF1ZSBNRDUgaGFzaGVzWy9ncmVlbl0iKQogICAgICAgIGNvbnNvbGUucHJpbnQoZiJbZ3JlZW5dTG9hZGVkIHtsZW4oc2VsZi5zaGExX2hhc2hlcyl9IHVuaXF1ZSBTSEExIGhhc2hlc1svZ3JlZW5dIikKCiAgICBkZWYgY3JhY2soc2VsZik6CiAgICAgICAgY29uc29sZS5wcmludCgiW3llbGxvd11TdGFydGluZyB0byBjcmFjayBoYXNoZXMuLi5bL3llbGxvd10iKQogICAgICAgIHNlbGYuY3JhY2tfaGFzaGVzKHNlbGYubWQ1X2hhc2hlcywgIk1ENSIpCiAgICAgICAgc2VsZi5jcmFja19oYXNoZXMoc2VsZi5zaGExX2hhc2hlcywgIlNIQTEiKQogICAgICAgIHNlbGYuZGlzcGxheV9yZXN1bHRzKCkKCiAgICBkZWYgY3JhY2tfaGFzaGVzKHNlbGYsIGhhc2hlcywgaGFzaF90eXBlKToKICAgICAgICBmb3IgaGFzaF92YWwgaW4gdHJhY2soaGFzaGVzLCBkZXNjcmlwdGlvbj1mIkNyYWNraW5nIHtoYXNoX3R5cGV9IGhhc2hlcyIpOgogICAgICAgICAgICBwbGFpbnRleHQgPSBzZWxmLmNhY2hlLmdldChoYXNoX3ZhbCkKICAgICAgICAgICAgaWYgcGxhaW50ZXh0OgogICAgICAgICAgICAgICAgc2VsZi5mb3VuZF9oYXNoZXNbaGFzaF92YWxdID0gcGxhaW50ZXh0CiAgICAgICAgICAgICAgICBjb25zb2xlLnByaW50KGYiW2N5YW5de2hhc2hfdmFsfToge3BsYWludGV4dH0gKGZyb20gY2FjaGUpWy9jeWFuXSIpCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgcGxhaW50ZXh0ID0gc2VsZi5jcmFja193aXRoX3dvcmRsaXN0KGhhc2hfdmFsLCBoYXNoX3R5cGUpCiAgICAgICAgICAgIGlmIHBsYWludGV4dDoKICAgICAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoZiJbZ3JlZW5de2hhc2hfdmFsfToge3BsYWludGV4dH1bL2dyZWVuXSIpCiAgICAgICAgICAgICAgICBzZWxmLmZvdW5kX2hhc2hlc1toYXNoX3ZhbF0gPSBwbGFpbnRleHQKICAgICAgICAgICAgICAgIHNlbGYuYXBwZW5kX3RvX2NhY2hlKGhhc2hfdmFsLCBwbGFpbnRleHQpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBjb25zb2xlLnByaW50KGYiW3JlZF17aGFzaF92YWx9OiBOb3QgZm91bmRbL3JlZF0iKQogICAgICAgICAgICAgICAgc2VsZi51bmZvdW5kX2hhc2hlcy5hcHBlbmQoaGFzaF92YWwpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMC41KQoKICAgIGRlZiBjcmFja193aXRoX3dvcmRsaXN0KHNlbGYsIGhhc2hfdmFsLCBoYXNoX3R5cGUpOgogICAgICAgIHdpdGggYWxpdmVfYmFyKGxlbihzZWxmLndvcmRsaXN0KSwgYmFyPSdjbGFzc2ljMicsIHRpdGxlPWYiQ2hlY2tpbmcgd29yZGxpc3QgZm9yIHtoYXNoX3R5cGV9IikgYXMgYmFyOgogICAgICAgICAgICBmb3Igd29yZCBpbiBzZWxmLndvcmRsaXN0OgogICAgICAgICAgICAgICAgaWYgKGhhc2hfdHlwZSA9PSAiTUQ1IiBhbmQgaGFzaGxpYi5tZDUod29yZC5lbmNvZGUoKSkuaGV4ZGlnZXN0KCkgPT0gaGFzaF92YWwpIG9yIFwKICAgICAgICAgICAgICAgICAgIChoYXNoX3R5cGUgPT0gIlNIQTEiIGFuZCBoYXNobGliLnNoYTEod29yZC5lbmNvZGUoKSkuaGV4ZGlnZXN0KCkgPT0gaGFzaF92YWwpOgogICAgICAgICAgICAgICAgICAgIHJldHVybiB3b3JkCiAgICAgICAgICAgICAgICBiYXIoKQogICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIGxvYWRfY2FjaGUoc2VsZiwgZmlsZW5hbWU9ImNhY2hlIik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIG9wZW4oZmlsZW5hbWUsICdyJykgYXMgZmlsZToKICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgaWYgIjoiIGluIGxpbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGhhc2hfdmFsLCBwbGFpbnRleHQgPSBsaW5lLnN0cmlwKCkuc3BsaXQoIjoiLCAxKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNhY2hlW2hhc2hfdmFsXSA9IHBsYWludGV4dAogICAgICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoKICAgICAgICAgICAgcGFzcwoKICAgIGRlZiBhcHBlbmRfdG9fY2FjaGUoc2VsZiwgaGFzaF92YWwsIHBsYWludGV4dCwgZmlsZW5hbWU9ImNhY2hlIik6CiAgICAgICAgd2l0aCBvcGVuKGZpbGVuYW1lLCAiYSIpIGFzIGZpbGU6CiAgICAgICAgICAgIGZpbGUud3JpdGUoZiJ7aGFzaF92YWx9OntwbGFpbnRleHR9XG4iKQoKICAgIGRlZiBsb2FkX3dvcmRsaXN0KHNlbGYpOgogICAgICAgIHdvcmRsaXN0ID0gW10KICAgICAgICBmb3IgdXJsIGluIHNlbGYuV09SRExJU1RfVVJMUzoKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsKQogICAgICAgICAgICB3b3JkbGlzdC5leHRlbmQocmVzcG9uc2UudGV4dC5zcGxpdGxpbmVzKCkpCgogICAgICAgIGNvbnNvbGUucHJpbnQoZiJbZ3JlZW5dTG9hZGVkIHdvcmRsaXN0IHdpdGgge2xlbih3b3JkbGlzdCl9IGVudHJpZXNbL2dyZWVuXSIpCiAgICAgICAgcmV0dXJuIHdvcmRsaXN0CgogICAgZGVmIGRpc3BsYXlfYXNjaWlfYXJ0KHNlbGYpOgogICAgICAgIGNvbnNvbGUucHJpbnQoIiIiCltjeWFuXQpAQEBAQEBAQCAgICBAQEBAQEAgICAgQEBAQEBAICAgIEBAQEBAQCAgIEBAQEBAQEAgICAgQEBAQEBAICAgIEBAQEBAQCAgIEBAQEBAQEBAQEAgICAKQEBAQEBAQEBAICBAQEBAQEBAQCAgQEBAQEBAQCAgIEBAQEBAQEAgICBAQEBAQEBAQCAgQEBAQEBAQEAgIEBAQEBAQEBAICBAQEBAQEBAQEBAQCAgCkBAISAgQEBAICBAQCEgIEBAQCAgIUBAICAgICAgICFAQCAgICAgICBAQCEgIEBAQCAgQEAhICBAQEAgIEBAISAgQEBAICBAQCEgQEAhIEBAISAgCiFAISAgQCFAICAhQCEgIEAhQCAgIUAhICAgICAgICFAISAgICAgICAhQCEgIEAhQCAgIUAhICBAIUAgICFAISAgQCFAICAhQCEgIUAhICFAISAgCkAhQEAhQCEgICBAIUAhQCFAISAgISFAQCEhICAgICEhQEAhISAgICBAIUAgICFAISAgQCFAICAhQCEgIEAhQCAgIUAhICBAISEgISFAIEAhQCAgCiEhQCEhISAgICAhISFAISEhISAgICEhQCEhISAgICAhIUAhISEgICAhQCEgICEhISAgIUAhICAhISEgICFAISAgISEhICAhQCEgICAhICFAISAgCiEhOiAgICAgICAhITogICEhISAgICAgICAhOiEgICAgICAgITohICAhITogICEhISAgISE6ICAhISEgICEhOiAgISEhICAhITogICAgICEhOiAgCjohOiAgICAgICA6ITogICE6ISAgICAgICE6ISAgICAgICAhOiEgICA6ITogICE6ISAgOiE6ICAhOiEgIDohOiAgITohICA6ITogICAgIDohOiAgCiA6OiAgICAgICA6OiAgIDo6OiAgOjo6OiA6OiAgIDo6OjogOjogICAgOjo6OiA6OiAgOjo6OjogOjogIDo6Ojo6IDo6ICA6OjogICAgIDo6ICAgCiA6ICAgICAgICAgOiAgIDogOiAgOjogOiA6ICAgIDo6IDogOiAgICA6OiA6ICA6ICAgIDogOiAgOiAgICA6IDogIDogICAgOiAgICAgIDogICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24gMC4wLjEKWy9jeWFuXQogICAgICAgICIiIikKCiAgICBkZWYgZGlzcGxheV9yZXN1bHRzKHNlbGYpOgogICAgICAgICIiIkRpc3BsYXlzIHRoZSByZXN1bHRzIG9mIHRoZSBoYXNoIGNyYWNraW5nIHByb2Nlc3MuIiIiCiAgICAgICAgaWYgc2VsZi5mb3VuZF9oYXNoZXM6CiAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoIlxuW2JvbGQgZ3JlZW5dQ3JhY2tlZCBIYXNoZXM6Wy9ib2xkIGdyZWVuXSIpCiAgICAgICAgICAgIGZvciBoYXNoX3ZhbCwgcGxhaW50ZXh0IGluIHNlbGYuZm91bmRfaGFzaGVzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBjb25zb2xlLnByaW50KGYiW2dyZWVuXXtoYXNoX3ZhbH0gOiB7cGxhaW50ZXh0fVsvZ3JlZW5dIikKICAgICAgICAgICAgY29uc29sZS5wcmludCgiW2JvbGQgY3lhbl1SZW1lbWJlciwgZG9uJ3QgaHVydCBhbnlvbmUsIGJ1dCBoYXZlIGZ1biFbL2JvbGQgY3lhbl0iKQogICAgICAgIAogICAgICAgIGlmIHNlbGYudW5mb3VuZF9oYXNoZXM6CiAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoIlxuW2JvbGQgcmVkXVVuY3JhY2tlZCBIYXNoZXM6Wy9ib2xkIHJlZF0iKQogICAgICAgICAgICBmb3IgaGFzaF92YWwgaW4gc2VsZi51bmZvdW5kX2hhc2hlczoKICAgICAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoZiJbcmVkXXtoYXNoX3ZhbH0gOiBOb3QgZm91bmRbL3JlZF0iKQogICAgICAgICAgICBjb25zb2xlLnByaW50KCJbYm9sZCB5ZWxsb3ddTG9va3MgbGlrZSB0aGVzZSBvbmVzIGFyZSBwbGF5aW5nIGhpZGUgYW5kIHNlZWshWy9ib2xkIHllbGxvd10iKQoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGltcG9ydCBzeXMKICAgIGlmIGxlbihzeXMuYXJndikgPT0gMjoKICAgICAgICBIYXNoQ3JhY2tlcihzeXMuYXJndlsxXSkuY3JhY2soKQogICAgZWxzZToKICAgICAgICBIYXNoQ3JhY2tlcigpCg=="
exec(base64.b64decode(encoded_kod).decode("utf-8"))
