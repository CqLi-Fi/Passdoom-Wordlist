import base64
encoded_kod = "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoKaW1wb3J0IHRpbWUKaW1wb3J0IHJhbmRvbQppbXBvcnQgaGFzaGxpYgppbXBvcnQgcmVxdWVzdHMKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgZGVmYXVsdGRpY3QKZnJvbSByaWNoLmNvbnNvbGUgaW1wb3J0IENvbnNvbGUKZnJvbSByaWNoLnRhYmxlIGltcG9ydCBUYWJsZQpmcm9tIHJpY2gucHJvZ3Jlc3MgaW1wb3J0IHRyYWNrCmZyb20gYWxpdmVfcHJvZ3Jlc3MgaW1wb3J0IGFsaXZlX2JhcgoKY29uc29sZSA9IENvbnNvbGUoKQoKY2xhc3MgSGFzaENyYWNrZXI6CiAgICBWRVJTSU9OID0gIjAuMC4xIgogICAgREVTQ1JJUFRJT04gPSAiUGFzc2Rvb20gSGFzaCBDcmFja2VyIgogICAgQVVUSE9SID0gIkNxTGkiCiAgICBXT1JETElTVF9DUkVBVE9SID0gIldvcmRsaXN0IEFyY2hpdGVjdDogQ3FMaSIKICAgIFdPUkRMSVNUX1VSTFMgPSBbCiAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9DcUxpLUZpL1Bhc3Nkb29tLVdvcmRsaXN0L3JlZnMvaGVhZHMvbWFpbi9Xb3JkbGlzdC90dXJraXNoLnR4dCcsCiAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9DcUxpLUZpL1Bhc3Nkb29tLVdvcmRsaXN0L3JlZnMvaGVhZHMvbWFpbi9Xb3JkbGlzdC90dXJraXNoMi50eHQnLAogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ3FMaS1GaS9QYXNzZG9vbS1Xb3JkbGlzdC9yZWZzL2hlYWRzL21haW4vV29yZGxpc3QvZW5nbGlzaC50eHQnLAogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ3FMaS1GaS9QYXNzZG9vbS1Xb3JkbGlzdC9yZWZzL2hlYWRzL21haW4vV29yZGxpc3QvbnVtYmVycy50eHQnLAogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ3FMaS1GaS9QYXNzZG9vbS1Xb3JkbGlzdC9yZWZzL2hlYWRzL21haW4vV29yZGxpc3QvZnRwLnR4dCcKICAgIF0KCiAgICBkZWYgX19pbml0X18oc2VsZiwgZmlsZW5hbWU9Tm9uZSk6CiAgICAgICAgc2VsZi5kaXNwbGF5X2ludHJvX2FuaW1hdGlvbigpCiAgICAgICAgaWYgZmlsZW5hbWU6CiAgICAgICAgICAgIHNlbGYuZmlsZW5hbWUgPSBmaWxlbmFtZQogICAgICAgICAgICBzZWxmLm1kNV9oYXNoZXMgPSBbXQogICAgICAgICAgICBzZWxmLnNoYTFfaGFzaGVzID0gW10KICAgICAgICAgICAgc2VsZi5mb3VuZF9oYXNoZXMgPSB7fQogICAgICAgICAgICBzZWxmLnVuZm91bmRfaGFzaGVzID0gW10KICAgICAgICAgICAgc2VsZi5jYWNoZSA9IGRlZmF1bHRkaWN0KHN0cikKICAgICAgICAgICAgc2VsZi5sb2FkX2hhc2hlcygpCiAgICAgICAgICAgIHNlbGYubG9hZF9jYWNoZSgpCiAgICAgICAgICAgIHNlbGYud29yZGxpc3QgPSBzZWxmLmxvYWRfd29yZGxpc3QoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZGlzcGxheV91c2FnZV9pbnN0cnVjdGlvbnMoKQoKICAgIGRlZiBkaXNwbGF5X2ludHJvX2FuaW1hdGlvbihzZWxmKToKICAgICAgICAiIiJEaXNwbGF5cyB0aGUgbWF0cml4LXN0eWxlIGludHJvIGFuaW1hdGlvbi4iIiIKICAgICAgICBjb25zb2xlLnByaW50KCJcbltib2xkIGdyZWVuXVBhc3Nkb29tIEhhc2ggQ3JhY2tlclsvYm9sZCBncmVlbl1cbiIsIHN0eWxlPSJib2xkIGdyZWVuIikKICAgICAgICBhbmltYXRpb25fY2hhcmFjdGVycyA9IFsKICAgICAgICAgICAgIkEuQi5HLkUuUi5ULlkuUi5XLkUuUS5XLkUuUlcuIiwKICAgICAgICAgICAgIjEuMy40LjI1LjI2LjM2LjMuNi4zLjMuNy4zLjYzLjIiLAogICAgICAgICAgICAiKyUmLy8lKyUmLygpPT89KC8mKyteIiwKICAgICAgICAgICAgIkAjJCUmKigpIV4rPS1bXXt9OzosLi88Pj8iCiAgICAgICAgXQogICAgICAgIAogICAgICAgIGZvciBfIGluIHJhbmdlKDMwKToKICAgICAgICAgICAgY29uc29sZS5wcmludCgKICAgICAgICAgICAgICAgIHJhbmRvbS5jaG9pY2UoYW5pbWF0aW9uX2NoYXJhY3RlcnMpLAogICAgICAgICAgICAgICAgc3R5bGU9ImJvbGQgY3lhbiIgaWYgcmFuZG9tLnJhbmRpbnQoMCwgMSkgZWxzZSAiYm9sZCBncmVlbiIKICAgICAgICAgICAgKQogICAgICAgICAgICB0aW1lLnNsZWVwKDAuMDMpCiAgICAgICAgCiAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgIGNvbnNvbGUucHJpbnQoIltib2xkIGN5YW5dLS0tIFdlbGNvbWUgdG8gUGFzc2Rvb20gLS0tWy9ib2xkIGN5YW5dIikKICAgICAgICB0aW1lLnNsZWVwKDEpCgogICAgZGVmIGRpc3BsYXlfdXNhZ2VfaW5zdHJ1Y3Rpb25zKHNlbGYpOgogICAgICAgIGNvbnNvbGUucHJpbnQoIlt5ZWxsb3ddVXNhZ2UgZXhhbXBsZTogcHl0aG9uMyBwYXNzZG9vbS5weSBoYXNoLnR4dFsveWVsbG93XVxuIikKICAgICAgICBjb25zb2xlLnByaW50KGYiW3llbGxvd117c2VsZi5ERVNDUklQVElPTn0ge3NlbGYuVkVSU0lPTn1bL3llbGxvd10iKQogICAgICAgIGNvbnNvbGUucHJpbnQoZiJbeWVsbG93XXtzZWxmLkFVVEhPUn0gLSB7c2VsZi5XT1JETElTVF9DUkVBVE9SfVxuWy95ZWxsb3ddIikKCiAgICBkZWYgbG9hZF9oYXNoZXMoc2VsZik6CiAgICAgICAgd2l0aCBvcGVuKHNlbGYuZmlsZW5hbWUsICdyJykgYXMgZmlsZToKICAgICAgICAgICAgZm9yIGxpbmUgaW4gZmlsZToKICAgICAgICAgICAgICAgIGxpbmUgPSBsaW5lLnN0cmlwKCkKICAgICAgICAgICAgICAgIGlmIGxlbihsaW5lKSA9PSAzMiBhbmQgYWxsKGMgaW4gJzAxMjM0NTY3ODlhYmNkZWZBQkNERUYnIGZvciBjIGluIGxpbmUpOgogICAgICAgICAgICAgICAgICAgIHNlbGYubWQ1X2hhc2hlcy5hcHBlbmQobGluZS5sb3dlcigpKQogICAgICAgICAgICAgICAgZWxpZiBsZW4obGluZSkgPT0gNDAgYW5kIGFsbChjIGluICcwMTIzNDU2Nzg5YWJjZGVmQUJDREVGJyBmb3IgYyBpbiBsaW5lKToKICAgICAgICAgICAgICAgICAgICBzZWxmLnNoYTFfaGFzaGVzLmFwcGVuZChsaW5lLmxvd2VyKCkpCgogICAgICAgIGNvbnNvbGUucHJpbnQoZiJbZ3JlZW5dTG9hZGVkIHtsZW4oc2VsZi5tZDVfaGFzaGVzKX0gdW5pcXVlIE1ENSBoYXNoZXNbL2dyZWVuXSIpCiAgICAgICAgY29uc29sZS5wcmludChmIltncmVlbl1Mb2FkZWQge2xlbihzZWxmLnNoYTFfaGFzaGVzKX0gdW5pcXVlIFNIQTEgaGFzaGVzWy9ncmVlbl0iKQoKICAgIGRlZiBjcmFjayhzZWxmKToKICAgICAgICBjb25zb2xlLnByaW50KCJbeWVsbG93XVN0YXJ0aW5nIHRvIGNyYWNrIGhhc2hlcy4uLlsveWVsbG93XSIpCiAgICAgICAgc2VsZi5jcmFja19oYXNoZXMoc2VsZi5tZDVfaGFzaGVzLCAiTUQ1IikKICAgICAgICBzZWxmLmNyYWNrX2hhc2hlcyhzZWxmLnNoYTFfaGFzaGVzLCAiU0hBMSIpCiAgICAgICAgc2VsZi5kaXNwbGF5X3Jlc3VsdHMoKQoKICAgIGRlZiBjcmFja19oYXNoZXMoc2VsZiwgaGFzaGVzLCBoYXNoX3R5cGUpOgogICAgICAgIGZvciBoYXNoX3ZhbCBpbiB0cmFjayhoYXNoZXMsIGRlc2NyaXB0aW9uPWYiQ3JhY2tpbmcge2hhc2hfdHlwZX0gaGFzaGVzIik6CiAgICAgICAgICAgIHBsYWludGV4dCA9IHNlbGYuY2FjaGUuZ2V0KGhhc2hfdmFsKQogICAgICAgICAgICBpZiBwbGFpbnRleHQ6CiAgICAgICAgICAgICAgICBzZWxmLmZvdW5kX2hhc2hlc1toYXNoX3ZhbF0gPSBwbGFpbnRleHQKICAgICAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoZiJbY3lhbl17aGFzaF92YWx9OiB7cGxhaW50ZXh0fSAoZnJvbSBjYWNoZSlbL2N5YW5dIikKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBwbGFpbnRleHQgPSBzZWxmLmNyYWNrX3dpdGhfd29yZGxpc3QoaGFzaF92YWwsIGhhc2hfdHlwZSkKICAgICAgICAgICAgaWYgcGxhaW50ZXh0OgogICAgICAgICAgICAgICAgY29uc29sZS5wcmludChmIltncmVlbl17aGFzaF92YWx9OiB7cGxhaW50ZXh0fVsvZ3JlZW5dIikKICAgICAgICAgICAgICAgIHNlbGYuZm91bmRfaGFzaGVzW2hhc2hfdmFsXSA9IHBsYWludGV4dAogICAgICAgICAgICAgICAgc2VsZi5hcHBlbmRfdG9fY2FjaGUoaGFzaF92YWwsIHBsYWludGV4dCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoZiJbcmVkXXtoYXNoX3ZhbH06IE5vdCBmb3VuZFsvcmVkXSIpCiAgICAgICAgICAgICAgICBzZWxmLnVuZm91bmRfaGFzaGVzLmFwcGVuZChoYXNoX3ZhbCkKICAgICAgICAgICAgdGltZS5zbGVlcCgwLjUpCgogICAgZGVmIGNyYWNrX3dpdGhfd29yZGxpc3Qoc2VsZiwgaGFzaF92YWwsIGhhc2hfdHlwZSk6CiAgICAgICAgd2l0aCBhbGl2ZV9iYXIobGVuKHNlbGYud29yZGxpc3QpLCBiYXI9J2NsYXNzaWMyJywgdGl0bGU9ZiJDaGVja2luZyB3b3JkbGlzdCBmb3Ige2hhc2hfdHlwZX0iKSBhcyBiYXI6CiAgICAgICAgICAgIGZvciB3b3JkIGluIHNlbGYud29yZGxpc3Q6CiAgICAgICAgICAgICAgICBpZiAoaGFzaF90eXBlID09ICJNRDUiIGFuZCBoYXNobGliLm1kNSh3b3JkLmVuY29kZSgpKS5oZXhkaWdlc3QoKSA9PSBoYXNoX3ZhbCkgb3IgXAogICAgICAgICAgICAgICAgICAgKGhhc2hfdHlwZSA9PSAiU0hBMSIgYW5kIGhhc2hsaWIuc2hhMSh3b3JkLmVuY29kZSgpKS5oZXhkaWdlc3QoKSA9PSBoYXNoX3ZhbCk6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmQKICAgICAgICAgICAgICAgIGJhcigpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgbG9hZF9jYWNoZShzZWxmLCBmaWxlbmFtZT0iY2FjaGUiKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdpdGggb3BlbihmaWxlbmFtZSwgJ3InKSBhcyBmaWxlOgogICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gZmlsZToKICAgICAgICAgICAgICAgICAgICBpZiAiOiIgaW4gbGluZToKICAgICAgICAgICAgICAgICAgICAgICAgaGFzaF92YWwsIHBsYWludGV4dCA9IGxpbmUuc3RyaXAoKS5zcGxpdCgiOiIsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2FjaGVbaGFzaF92YWxdID0gcGxhaW50ZXh0CiAgICAgICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgogICAgICAgICAgICBwYXNzCgogICAgZGVmIGFwcGVuZF90b19jYWNoZShzZWxmLCBoYXNoX3ZhbCwgcGxhaW50ZXh0LCBmaWxlbmFtZT0iY2FjaGUiKToKICAgICAgICB3aXRoIG9wZW4oZmlsZW5hbWUsICJhIikgYXMgZmlsZToKICAgICAgICAgICAgZmlsZS53cml0ZShmIntoYXNoX3ZhbH06e3BsYWludGV4dH1cbiIpCgogICAgZGVmIGxvYWRfd29yZGxpc3Qoc2VsZik6CiAgICAgICAgd29yZGxpc3QgPSBbXQogICAgICAgIGZvciB1cmwgaW4gc2VsZi5XT1JETElTVF9VUkxTOgogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwpCiAgICAgICAgICAgIHdvcmRsaXN0LmV4dGVuZChyZXNwb25zZS50ZXh0LnNwbGl0bGluZXMoKSkKCiAgICAgICAgY29uc29sZS5wcmludChmIltncmVlbl1Mb2FkZWQgd29yZGxpc3Qgd2l0aCB7bGVuKHdvcmRsaXN0KX0gZW50cmllc1svZ3JlZW5dIikKICAgICAgICByZXR1cm4gd29yZGxpc3QKCiAgICBkZWYgZGlzcGxheV9hc2NpaV9hcnQoc2VsZik6CiAgICAgICAgY29uc29sZS5wcmludCgiIiIKW2N5YW5dCkBAQEBAQEBAICAgIEBAQEBAQCAgICBAQEBAQEAgICAgQEBAQEBAICAgQEBAQEBAQCAgICBAQEBAQEAgICAgQEBAQEBAICAgQEBAQEBAQEBAQCAgIApAQEBAQEBAQEAgIEBAQEBAQEBAICBAQEBAQEBAICAgQEBAQEBAQCAgIEBAQEBAQEBAICBAQEBAQEBAQCAgQEBAQEBAQEAgIEBAQEBAQEBAQEBAICAKQEAhICBAQEAgIEBAISAgQEBAICAhQEAgICAgICAgIUBAICAgICAgIEBAISAgQEBAICBAQCEgIEBAQCAgQEAhICBAQEAgIEBAISBAQCEgQEAhICAKIUAhICBAIUAgICFAISAgQCFAICAhQCEgICAgICAgIUAhICAgICAgICFAISAgQCFAICAhQCEgIEAhQCAgIUAhICBAIUAgICFAISAhQCEgIUAhICAKQCFAQCFAISAgIEAhQCFAIUAhICAhIUBAISEgICAgISFAQCEhICAgIEAhQCAgIUAhICBAIUAgICFAISAgQCFAICAhQCEgIEAhISAhIUAgQCFAICAKISFAISEhICAgICEhIUAhISEhICAgISFAISEhICAgICEhQCEhISAgICFAISAgISEhICAhQCEgICEhISAgIUAhICAhISEgICFAISAgICEgIUAhICAKISE6ICAgICAgICEhOiAgISEhICAgICAgICE6ISAgICAgICAhOiEgICEhOiAgISEhICAhITogICEhISAgISE6ICAhISEgICEhOiAgICAgISE6ICAKOiE6ICAgICAgIDohOiAgITohICAgICAgITohICAgICAgICE6ISAgIDohOiAgITohICA6ITogICE6ISAgOiE6ICAhOiEgIDohOiAgICAgOiE6ICAKIDo6ICAgICAgIDo6ICAgOjo6ICA6Ojo6IDo6ICAgOjo6OiA6OiAgICA6Ojo6IDo6ICA6Ojo6OiA6OiAgOjo6OjogOjogIDo6OiAgICAgOjogICAKIDogICAgICAgICA6ICAgOiA6ICA6OiA6IDogICAgOjogOiA6ICAgIDo6IDogIDogICAgOiA6ICA6ICAgIDogOiAgOiAgICA6ICAgICAgOiAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbiAwLjAuMQpbL2N5YW5dCiAgICAgICAgIiIiKQoKICAgIGRlZiBkaXNwbGF5X3Jlc3VsdHMoc2VsZik6CiAgICAgICAgIiIiRGlzcGxheXMgdGhlIHJlc3VsdHMgb2YgdGhlIGhhc2ggY3JhY2tpbmcgcHJvY2Vzcy4iIiIKICAgICAgICBpZiBzZWxmLmZvdW5kX2hhc2hlczoKICAgICAgICAgICAgY29uc29sZS5wcmludCgiXG5bYm9sZCBncmVlbl1DcmFja2VkIEhhc2hlczpbL2JvbGQgZ3JlZW5dIikKICAgICAgICAgICAgZm9yIGhhc2hfdmFsLCBwbGFpbnRleHQgaW4gc2VsZi5mb3VuZF9oYXNoZXMuaXRlbXMoKToKICAgICAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoZiJbZ3JlZW5de2hhc2hfdmFsfSA6IHtwbGFpbnRleHR9Wy9ncmVlbl0iKQogICAgICAgICAgICBjb25zb2xlLnByaW50KCJbYm9sZCBjeWFuXVJlbWVtYmVyLCBkb24ndCBodXJ0IGFueW9uZSwgYnV0IGhhdmUgZnVuIVsvYm9sZCBjeWFuXSIpCiAgICAgICAgCiAgICAgICAgaWYgc2VsZi51bmZvdW5kX2hhc2hlczoKICAgICAgICAgICAgY29uc29sZS5wcmludCgiXG5bYm9sZCByZWRdVW5jcmFja2VkIEhhc2hlczpbL2JvbGQgcmVkXSIpCiAgICAgICAgICAgIGZvciBoYXNoX3ZhbCBpbiBzZWxmLnVuZm91bmRfaGFzaGVzOgogICAgICAgICAgICAgICAgY29uc29sZS5wcmludChmIltyZWRde2hhc2hfdmFsfSA6IE5vdCBmb3VuZFsvcmVkXSIpCiAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoIltib2xkIHllbGxvd11Mb29rcyBsaWtlIHRoZXNlIG9uZXMgYXJlIHBsYXlpbmcgaGlkZSBhbmQgc2VlayFbL2JvbGQgeWVsbG93XSIpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgaW1wb3J0IHN5cwogICAgaWYgbGVuKHN5cy5hcmd2KSA9PSAyOgogICAgICAgIEhhc2hDcmFja2VyKHN5cy5hcmd2WzFdKS5jcmFjaygpCiAgICBlbHNlOgogICAgICAgIEhhc2hDcmFja2VyKCkK"
exec(base64.b64decode(encoded_kod).decode("utf-8"))
